CHAPTER 15: EXPLOITING INFORMATION DISCLOSURE

# Exploiting Error Messages
1. When you are probing the application for common vulnerabilities by submitting crafted attack strings in different parameters, always monitor the application's response to identify any error messages that may contain useful information. Attempt to force an error response from the app by supplying encrypted data strings in the wrong context, or by performing actions on resources that are not in the correct state to handle the action.
2. Be aware that error information that is returned withing the server's response may not be rendered on-screen whithin the browser. An efficient way to identify many error conditions is to search each raw response for keywords that are often contained in error messages. For example:
```
error
exception
illegal
invalid
fail
stack
access
directory
file
not found
var char
ODBC
SQL
SELECT
```
3. When you send a series of requests modifying parameters within a base request, check whether the original response already contains any of the keywords you are looking for to avoid false positives.
4. YOu can use the Grep function of Burp Intruder to quickly identify any occurences of interesting keywords in any of the responses generated by a given attack. (see Chapter 14). Where matches are found, review the relevant responses manually to determine whether any useful error information has been returned.
## **USING PUBLIC INFORMATION**
1. Search for the text of any unusual error messages using standard search engines. You can use various advanced search features to narrrow down you results. For example:
```
"unable to retrieve" filetype:jpg
```
2. Review the search results, looking both for any discussion about he error message and for any other websites in which the same message has appeared. Other apps may produce the same message in a more verbose context, enabling you to better understand what kind of conditions give rise to the error. Use the search engine cache to retrieve examples of error messages that no longer appear within the live application.
3. Use Google code search to locate any publicly available code that may be responsible for a particular error message. Search for snippets of error messages that may be hard-coded into the app's source code. You can also use various advanced seach features to specify the code language and other details if these are known. For example:
```
unable\ to\ retrieve lang:php package:mail
```
4. If you have obtained stack traces containing the names of library and third-party code components, search for these names on both types of search engines.
# Gathering Published Information
1. Review the results of your application mapping exercise (see Chapter 4) to identify all server-side functionality and client-side data that may be used to obtain useful information.
2. Identify any locations within the app where sensitive data such as passwords or credit card details are transmitted from the server to the browser. Even if these are masked on-screen, they are still viewable within the server's response. If you have found another suitable vulnerability, such as within access controls or session handling, this behavior can be used to obtain the information belonging to other application users.
3. If you identify any means of extracting sensitive information, use the techniques described in Chapter 14 to automate the process.
# Using Inference
1. Differences in the timing of application responses may be subtl and difficult to detect. In a typical situation, it is worth probing the app for this behavior only in selected key areas where a crucial item of interesting data is submitted and where the kind of processing being performed is likely to result in time differences.
2. To test a particular function, compile one list containing several items that are known to be valid (or that have been accessed recently) and a second list containing items that are known to be invalid (or dormant). Make requests containing each item on these lists in a controlled way, issuing only one request at a time, and monitoring the time taken for the app to respond to each request. Determine whether there is any correlation between the item's status and the time taken to respond.
3. You can use Burp Intruder to automate this task. For every request it generates, Intruder automatically records the time taken before the application responds and the time taken to complete the response. You can sort a table of results by either of these attributes to quickly identify any obvious correlations.












































